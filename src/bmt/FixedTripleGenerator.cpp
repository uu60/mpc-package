//
// Created by 杜建璋 on 2024/8/30.
//

#include "bmt/FixedTripleGenerator.h"
#include "utils/Mpi.h"
#include "utils/Math.h"

template<typename T>
FixedTripleGenerator<T>::FixedTripleGenerator() = default;

template<typename T>
FixedTripleGenerator<T> *FixedTripleGenerator<T>::execute(bool dummy) {
    int idx = 0;
    if (Mpi::rank() == 0) {
        idx = Math::rand32(0, 99);
        Mpi::ssend(&idx);
    } else {
        Mpi::srecv(&idx);
    }
    std::tuple<std::pair<T, T>, std::pair<T, T>, std::pair<T, T>> triple = getRandomTriple(
            idx);
    if (Mpi::rank() == 0) {
        this->_ai = std::get<0>(triple).first;
        this->_bi = std::get<1>(triple).first;
        this->_ci = std::get<2>(triple).first;
    } else {
        this->_ai = std::get<0>(triple).second;
        this->_bi = std::get<1>(triple).second;
        this->_ci = std::get<2>(triple).second;
    }
    return this;
}

template<typename T>
std::string FixedTripleGenerator<T>::tag() const {
    return "[Fixed BMT Generator]";
}

template<typename T>
std::tuple<std::pair<T, T>, std::pair<T, T>, std::pair<T, T>>
FixedTripleGenerator<T>::getRandomTriple(int idx) {
    const std::array<std::tuple<std::pair<T, T>, std::pair<T, T>, std::pair<T, T>>, 100> *triple;
    if constexpr (std::is_same_v<T, bool>) {
        triple = &TRIPLES_1;
    } else if constexpr (std::is_same_v<T, int8_t>) {
        triple = &TRIPLES_8;
    } else if constexpr (std::is_same_v<T, int16_t>) {
        triple = &TRIPLES_16;
    } else if constexpr (std::is_same_v<T, int32_t>) {
        triple = &TRIPLES_32;
    } else {
        triple = &TRIPLES_64;
    }
    return (*triple)[idx];
}

template<typename T>
const std::array<std::tuple<std::pair<bool, bool>, std::pair<bool, bool>, std::pair<bool,
        bool>>, 100> FixedTripleGenerator<T>::TRIPLES_1 = {
        {{{1, 1}, {0, 0}, {1, 1}}, {{0, 1}, {0, 0}, {1, 1}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 1}, {1, 0}, {1, 1}},
         {{1, 1}, {0, 0}, {1, 1}}, {{0, 0}, {1, 0}, {0, 0}}, {{1, 0}, {1, 0}, {1, 0}}, {{0, 0}, {1, 0}, {0, 0}},
         {{0, 0}, {0, 0}, {1, 1}}, {{0, 1}, {0, 1}, {0, 1}}, {{1, 0}, {0, 0}, {0, 0}}, {{1, 0}, {1, 1}, {0, 0}},
         {{1, 0}, {1, 0}, {0, 1}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 1}, {1, 0}, {1, 0}}, {{0, 0}, {0, 0}, {0, 0}},
         {{1, 1}, {1, 1}, {0, 0}}, {{1, 1}, {0, 0}, {0, 0}}, {{0, 0}, {0, 1}, {1, 1}}, {{0, 0}, {1, 1}, {0, 0}},
         {{0, 1}, {1, 1}, {0, 0}}, {{1, 1}, {1, 1}, {1, 1}}, {{0, 0}, {1, 0}, {0, 0}}, {{1, 1}, {1, 0}, {1, 1}},
         {{0, 0}, {1, 0}, {1, 1}}, {{1, 1}, {1, 0}, {0, 0}}, {{0, 0}, {1, 0}, {1, 1}}, {{1, 1}, {0, 1}, {0, 0}},
         {{1, 1}, {0, 0}, {1, 1}}, {{1, 0}, {0, 0}, {1, 1}}, {{0, 0}, {0, 1}, {0, 0}}, {{0, 1}, {1, 1}, {1, 1}},
         {{0, 1}, {0, 1}, {1, 0}}, {{1, 1}, {0, 1}, {0, 0}}, {{1, 0}, {0, 0}, {0, 0}}, {{1, 1}, {1, 0}, {0, 0}},
         {{0, 1}, {0, 0}, {1, 1}}, {{0, 1}, {1, 1}, {1, 1}}, {{1, 0}, {0, 0}, {1, 1}}, {{1, 0}, {1, 1}, {0, 0}},
         {{1, 1}, {1, 1}, {1, 1}}, {{1, 1}, {0, 0}, {0, 0}}, {{1, 1}, {1, 0}, {1, 1}}, {{1, 1}, {1, 1}, {0, 0}},
         {{1, 1}, {0, 1}, {0, 0}}, {{1, 1}, {0, 0}, {1, 1}}, {{0, 0}, {1, 1}, {1, 1}}, {{1, 0}, {0, 1}, {1, 0}},
         {{0, 0}, {0, 1}, {1, 1}}, {{1, 1}, {0, 0}, {1, 1}}, {{1, 1}, {0, 1}, {0, 0}}, {{1, 0}, {1, 1}, {0, 0}},
         {{0, 1}, {0, 1}, {0, 1}}, {{1, 0}, {0, 1}, {0, 1}}, {{0, 1}, {1, 1}, {1, 1}}, {{1, 0}, {1, 1}, {0, 0}},
         {{0, 0}, {1, 0}, {0, 0}}, {{0, 1}, {1, 1}, {1, 1}}, {{0, 1}, {0, 0}, {1, 1}}, {{0, 1}, {0, 1}, {1, 0}},
         {{1, 1}, {1, 1}, {1, 1}}, {{0, 1}, {0, 1}, {0, 1}}, {{1, 0}, {0, 0}, {0, 0}}, {{0, 1}, {1, 0}, {1, 0}},
         {{1, 0}, {0, 1}, {0, 1}}, {{1, 0}, {0, 0}, {1, 1}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 1}, {0, 0}, {1, 1}},
         {{0, 0}, {0, 0}, {1, 1}}, {{1, 0}, {0, 0}, {1, 1}}, {{0, 0}, {1, 0}, {1, 1}}, {{1, 0}, {0, 0}, {0, 0}},
         {{1, 0}, {0, 0}, {1, 1}}, {{0, 1}, {1, 0}, {1, 0}}, {{1, 0}, {0, 1}, {0, 1}}, {{1, 1}, {1, 0}, {0, 0}},
         {{1, 0}, {0, 0}, {1, 1}}, {{1, 0}, {1, 0}, {0, 1}}, {{1, 1}, {0, 0}, {0, 0}}, {{0, 1}, {0, 0}, {1, 1}},
         {{1, 1}, {1, 1}, {1, 1}}, {{0, 1}, {1, 1}, {1, 1}}, {{0, 1}, {1, 1}, {0, 0}}, {{1, 1}, {1, 0}, {1, 1}},
         {{0, 0}, {1, 1}, {1, 1}}, {{0, 0}, {0, 1}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {1, 1}, {1, 1}},
         {{0, 0}, {1, 1}, {1, 1}}, {{0, 0}, {1, 1}, {1, 1}}, {{1, 0}, {1, 1}, {1, 1}}, {{1, 0}, {0, 1}, {1, 0}},
         {{1, 0}, {0, 0}, {1, 1}}, {{1, 1}, {1, 0}, {1, 1}}, {{0, 0}, {1, 0}, {0, 0}}, {{1, 1}, {0, 0}, {1, 1}},
         {{0, 1}, {0, 1}, {1, 0}}, {{0, 1}, {1, 0}, {1, 0}}, {{0, 1}, {0, 1}, {0, 1}}, {{0, 1}, {1, 1}, {0, 0}}}};

template<typename T>
const std::array<std::tuple<std::pair<int8_t, int8_t>, std::pair<int8_t, int8_t>, std::pair<int8_t, int8_t>>, 100> FixedTripleGenerator<T>::TRIPLES_8 = {
        {{{60, -121}, {108, 55}, {-8, 49}}, {{106, -123}, {-72, 54}, {120, -70}}, {{-24, 73}, {-114, 127}, {21, 104}},
         {{-63, -30}, {90, 121}, {-43, -124}}, {{48, 103}, {-115, -52}, {-100, -29}},
         {{102, -82}, {-102, -55}, {122, 66}}, {{125, -104}, {92, -127}, {88, -55}},
         {{-37, -127}, {-98, -19}, {-62, 50}}, {{-44, 71}, {103, 75}, {69, -127}}, {{5, -127}, {-128, -19}, {-61, 75}},
         {{-15, 35}, {23, 108}, {-63, 123}}, {{-64, 83}, {56, 10}, {61, -87}}, {{-66, -102}, {74, 16}, {18, -34}},
         {{93, 126}, {8, 104}, {64, -112}}, {{-44, -55}, {10, 28}, {98, -20}}, {{82, -34}, {-86, 43}, {-72, 56}},
         {{68, -92}, {77, -90}, {-62, 118}}, {{63, 66}, {-64, -64}, {36, 92}}, {{59, -76}, {114, 8}, {-85, 59}},
         {{95, -67}, {-38, -94}, {99, 45}}, {{-92, -101}, {98, -22}, {-29, -47}}, {{-15, 43}, {-12, -16}, {87, -103}},
         {{113, -126}, {-87, 90}, {25, -64}}, {{109, 124}, {62, -59}, {-124, 55}}, {{80, -13}, {1, -107}, {75, -9}},
         {{28, -68}, {31, -74}, {-86, 14}}, {{-101, -102}, {-83, 121}, {-46, 12}}, {{119, 13}, {65, 56}, {-92, -64}},
         {{87, -66}, {-53, 31}, {-53, 103}}, {{-81, 16}, {67, -86}, {-105, 60}}, {{-16, 20}, {-71, 11}, {38, -22}},
         {{110, -35}, {-93, 0}, {-113, 50}}, {{-70, 51}, {-126, 92}, {-62, -60}}, {{103, -120}, {106, 10}, {-51, 127}},
         {{52, 121}, {-123, 82}, {-31, 106}}, {{9, -11}, {30, -28}, {17, -21}}, {{102, -76}, {49, -117}, {62, -38}},
         {{-83, 12}, {-107, 99}, {71, -15}}, {{-91, 126}, {68, 34}, {-110, 96}}, {{63, -51}, {15, 90}, {-22, 2}},
         {{49, 29}, {-38, -38}, {-45, 5}}, {{127, -5}, {40, 38}, {-63, 107}}, {{38, 95}, {77, -7}, {74, 20}},
         {{-75, 125}, {41, 102}, {-115, 97}}, {{-36, -6}, {91, -31}, {0, 40}}, {{43, -99}, {6, 94}, {-126, -98}},
         {{-84, -6}, {-3, 107}, {120, -8}}, {{115, 28}, {-4, 91}, {-22, -81}}, {{40, 42}, {-54, 6}, {-34, -62}},
         {{-122, 24}, {-90, -52}, {-5, 97}}, {{-34, 38}, {86, 10}, {47, 81}}, {{-45, -22}, {-28, -31}, {-34, -109}},
         {{-52, 112}, {120, -127}, {85, 7}}, {{-37, 93}, {19, -54}, {82, 6}}, {{87, 114}, {121, -44}, {22, 95}},
         {{-119, -65}, {45, 22}, {120, 96}}, {{-32, 104}, {-110, 122}, {20, 76}}, {{-28, 104}, {-105, -19}, {-45, 93}},
         {{-105, 12}, {-7, -62}, {-79, 96}}, {{10, 66}, {-40, 53}, {104, 116}}, {{17, -101}, {68, 87}, {-28, 64}},
         {{59, 79}, {-44, -110}, {127, 125}}, {{115, 11}, {-77, -28}, {-55, -119}},
         {{-39, -27}, {103, -124}, {-66, -84}}, {{26, -103}, {53, -38}, {-122, -9}}, {{-117, 12}, {43, 118}, {39, -48}},
         {{-62, 25}, {106, 122}, {-19, 31}}, {{32, 120}, {-51, -23}, {-100, 116}}, {{-3, 3}, {126, 21}, {38, -38}},
         {{-99, 9}, {123, 0}, {31, -93}}, {{-41, 6}, {-86, 54}, {-98, -62}}, {{-72, 49}, {36, -64}, {-17, -107}},
         {{61, -30}, {71, -38}, {-8, 7}}, {{-14, -77}, {118, -105}, {-25, 122}}, {{23, -17}, {7, 39}, {46, -26}},
         {{29, 125}, {63, -68}, {121, -123}}, {{109, 115}, {-27, -38}, {-104, -120}}, {{-96, 101}, {71, 4}, {-50, -87}},
         {{12, -53}, {105, -71}, {29, 113}}, {{92, 87}, {-34, 78}, {-64, 4}}, {{65, -65}, {72, -41}, {70, -70}},
         {{-72, 101}, {107, -101}, {-99, 17}}, {{-11, -64}, {81, 68}, {-32, 121}},
         {{-19, -123}, {-110, -105}, {69, -3}}, {{-99, 36}, {-112, -91}, {49, -60}},
         {{107, -39}, {-38, -128}, {2, -26}}, {{35, 5}, {112, 72}, {-94, 30}}, {{-111, -8}, {-106, 6}, {121, 3}},
         {{-52, -21}, {4, 94}, {-119, -123}}, {{-101, -21}, {-34, -53}, {-110, -28}},
         {{-110, 58}, {-95, -120}, {96, 76}}, {{-5, 52}, {-103, -55}, {-30, 28}}, {{17, 67}, {9, -118}, {13, 47}},
         {{-96, -62}, {-123, -71}, {-24, -44}}, {{121, -74}, {-93, -44}, {-2, -37}}, {{30, -112}, {48, 49}, {53, -71}},
         {{7, -9}, {-34, -20}, {-72, -76}}, {{59, -107}, {-102, 64}, {-60, 92}}, {{-69, 45}, {37, 18}, {-31, -9}},
         {{-60, -125}, {87, 48}, {-94, -49}}}};

template<typename T>
const std::array<std::tuple<std::pair<int16_t, int16_t>, std::pair<int16_t, int16_t>, std::pair<int16_t, int16_t>>, 100> FixedTripleGenerator<T>::TRIPLES_16 = {
        {{{-22149, -2367}, {-14130, -571}, {19106, 8146}}, {{23152, 21578}, {20703, -19931}, {-3135, -2777}},
         {{18887, 30254}, {-4984, -13075}, {13763, -28106}}, {{-14508, -5562}, {-21570, 3739}, {-27469, 3543}},
         {{-6430, 32068}, {-22863, 5075}, {-20997, -28259}}, {{-13545, 23640}, {29946, -26532}, {-8744, 1138}},
         {{28608, 1517}, {-24434, -17728}, {1602, 21364}}, {{5605, -2834}, {-9592, 25884}, {-21618, 12446}},
         {{-30433, 14847}, {14235, -2281}, {23238, -19434}}, {{15550, 5394}, {-7786, 17342}, {-31574, 25494}},
         {{-14112, -22279}, {23470, -3665}, {18794, 22379}}, {{-10569, 19232}, {-31047, 4007}, {22430, 21250}},
         {{-21185, -22720}, {14810, -20631}, {-15416, -3979}}, {{-21, 12750}, {-965, 12167}, {12829, -28907}},
         {{-21216, -10312}, {-1990, 31487}, {-15324, -10252}}, {{30803, -25741}, {20969, 6660}, {404, 3770}},
         {{20954, -28121}, {-19749, -3265}, {22084, 30678}}, {{-27929, 4901}, {17379, 18475}, {-24527, 1143}},
         {{12608, 24182}, {-10567, -18516}, {32304, 10398}}, {{31230, -15460}, {11441, -26297}, {31046, -18966}},
         {{4520, 23472}, {-4041, 32474}, {-30505, -7679}}, {{4732, -1473}, {-13395, 10080}, {-11816, 21671}},
         {{-7505, -982}, {29968, -10033}, {-8419, -31510}}, {{3958, 698}, {-788, 10653}, {-15407, 6111}},
         {{7209, -22734}, {-17052, -5701}, {15453, -14168}}, {{30151, 1163}, {-32184, 8056}, {-28526, -16658}},
         {{13712, -3275}, {-2595, -31633}, {-22146, 21246}}, {{-3572, 12759}, {-9335, -4086}, {-27447, 1936}},
         {{22173, -22152}, {-19808, 22865}, {-31731, 30392}}, {{-9560, 31138}, {-6435, -21691}, {-7570, -31898}},
         {{-149, -14804}, {-13434, -11197}, {-32470, 27493}}, {{24020, 14453}, {2664, -7038}, {-17032, 32578}},
         {{-670, 10447}, {24460, -15080}, {1245, 22151}}, {{-31344, -22632}, {15218, 26927}, {-12993, 14569}},
         {{-3661, -6003}, {-28675, 28284}, {-26171, 3707}}, {{-4738, -9773}, {24422, -251}, {25546, -22255}},
         {{31735, -22646}, {9598, -26346}, {19356, -1800}}, {{417, -28898}, {16817, 23447}, {-26392, 16336}},
         {{-11553, 28053}, {16065, 15486}, {1358, -27842}}, {{18257, 31444}, {8979, 9333}, {-17477, -21779}},
         {{10505, 5126}, {-17492, 21883}, {27573, -8044}}, {{26648, 12691}, {-29049, -25777}, {26018, 29264}},
         {{-28905, -17959}, {7333, 23254}, {-21103, -4673}}, {{15477, -7365}, {-18218, 27923}, {-30428, -16884}},
         {{31253, 30982}, {12745, -17090}, {28417, 27580}}, {{-8945, -22137}, {-28469, -8237}, {-18499, -1833}},
         {{17408, 23384}, {29117, 26022}, {19877, 14691}}, {{-22197, 7411}, {30601, -25859}, {-19833, 28141}},
         {{13750, -5663}, {-16653, -7231}, {7250, -22566}}, {{-17584, 9138}, {29287, -737}, {23712, 15468}},
         {{4704, -26965}, {-22323, 28403}, {-5921, -9119}}, {{-21871, 32312}, {-30003, -12319}, {-22871, -17419}},
         {{-28321, 6678}, {-8937, -13047}, {-19203, 27555}}, {{-530, 21592}, {22311, 1571}, {5698, 8186}},
         {{-4621, 9781}, {-7997, -19072}, {27458, 19254}}, {{13271, -12092}, {-9785, -7723}, {-24637, 26545}},
         {{14251, 2239}, {29351, 25596}, {15224, 25606}}, {{-8882, -7530}, {10394, 23153}, {-21015, 15587}},
         {{-14367, 29474}, {-29372, -3216}, {23745, -24229}}, {{-17702, -23522}, {5320, 3966}, {5935, -16223}},
         {{-615, 24589}, {17341, -12607}, {-31812, 16376}}, {{-32161, 13238}, {23798, 20979}, {-5605, 5378}},
         {{31513, -19048}, {13494, -9931}, {-2174, -18439}}, {{553, -6713}, {26553, -26821}, {4076, 8404}},
         {{12585, -3626}, {10772, 4362}, {1831, -10309}}, {{14800, 17552}, {-26641, 2503}, {-8218, 22618}},
         {{-20760, -22060}, {-21079, -30625}, {-630, 28758}}, {{7360, -17697}, {-16296, -14519}, {-24323, -11518}},
         {{-12816, 28154}, {-13035, 29662}, {31000, -6650}}, {{26399, -12737}, {-16715, 20864}, {-4480, -522}},
         {{24027, -7443}, {17530, -31707}, {-27305, -6431}}, {{8198, -24463}, {26076, -3295}, {12813, -5234}},
         {{-23081, -16353}, {-7069, 50}, {31415, -2697}}, {{29738, 14516}, {-19310, 4600}, {8523, -15775}},
         {{18534, 27855}, {22746, -24240}, {-4002, -29612}}, {{7751, 16165}, {6777, 4349}, {-7356, 20612}},
         {{-15012, -30941}, {-19281, 11082}, {-31839, -31514}}, {{-23894, 27009}, {-16992, 28735}, {31497, -21140}},
         {{-21437, -23230}, {-14686, 19316}, {-29253, -12877}}, {{32596, 28650}, {3915, -25570}, {-7178, -22920}},
         {{21216, 8344}, {30147, -16619}, {5851, -18843}}, {{-3867, -433}, {17171, -18920}, {26602, 22994}},
         {{13972, 18548}, {-7753, 16360}, {-20298, 15682}}, {{-22358, 13497}, {-23790, -353}, {876, 20743}},
         {{18187, 7458}, {14364, -24876}, {3020, 31844}}, {{8192, 25024}, {-15476, 10783}, {-27292, -10788}},
         {{-5798, -22923}, {15755, -26491}, {30444, -28668}}, {{-23969, -2151}, {-22401, 18156}, {23425, -30937}},
         {{-21882, 11225}, {-25044, -7278}, {-20449, 18787}}, {{-25966, -22799}, {-11751, 24136}, {6351, 18900}},
         {{15856, -1599}, {-3166, 3625}, {-28215, 18578}}, {{-5900, 21688}, {-15254, -9030}, {10964, -21156}},
         {{-1141, -24632}, {-18231, -26333}, {19956, 9616}}, {{10170, 12680}, {-25114, 17610}, {-15337, -8887}},
         {{-19574, 26319}, {-1709, -13938}, {2955, -29010}}, {{-24850, 23908}, {7487, -27192}, {4290, 11132}},
         {{-884, 10407}, {-27412, 4692}, {26939, 10373}}, {{-31364, -28566}, {-24178, -4950}, {12003, 12141}},
         {{-25841, -6738}, {3738, 31379}, {-13223, -1568}}, {{29179, 32509}, {12334, -21652}, {16167, -8695}}}};

template<typename T>
const std::array<std::tuple<std::pair<int32_t, int32_t>, std::pair<int32_t, int32_t>, std::pair<int32_t, int32_t>>, 100> FixedTripleGenerator<T>::TRIPLES_32 = {
        {{{-387832999, -1527450567}, {802606078, -656860288}, {-1214111441, -615631187}},
         {{-1848221185, -179914245}, {1450418320, -1670014002}, {1078335083, -108869791}},
         {{213532459, -115505217}, {622165376, 787628757}, {-1921707203, 1891989621}},
         {{593277889, -69828916}, {-1505887696, -1515628177}, {-2141860153, 1712672204}},
         {{-2022523724, 315472332}, {507027870, -71020261}, {10950107, -1913418587}},
         {{-2110535061, -1763806462}, {2084134522, -1519334102}, {-246391530, 101862334}},
         {{-1840475095, -2023877506}, {-894031788, -385041544}, {-42839604, 1571170376}},
         {{703421999, -1629630513}, {-1179302064, 1482409857}, {1222075699, -1419048149}},
         {{918615038, 1803568427}, {-1790547763, 453976877}, {-1405533530, 1545523812}},
         {{-986842750, 2130370111}, {154979155, 352503763}, {1455896236, -240409862}},
         {{1521519845, -441167890}, {-94719432, 1882399476}, {-587103699, 507969815}},
         {{1327488974, 1007305434}, {-95524927, -565894110}, {1496029640, -1803921104}},
         {{1639319946, 783034382}, {-351778753, 995758330}, {744546818, -1461059370}},
         {{796141611, 735117951}, {1616761694, 1927907536}, {1448795182, -561125794}},
         {{-1079931869, 1369281749}, {-625858156, -1170150616}, {-1425360040, -1723016504}},
         {{1849515654, 1194271632}, {-71260121, 735751345}, {1145889891, -2025712083}},
         {{1270208739, -1527199099}, {1534159641, -286884265}, {51335356, -731261756}},
         {{1516649983, -363030842}, {-1886614342, 520135206}, {22503346, 1105146542}},
         {{652745184, 2037751915}, {-693166233, 1526414263}, {137631599, 617506395}},
         {{604530243, -305146992}, {-1649671108, -1525115266}, {-2046292223, 795271757}},
         {{-1279298222, -1072219032}, {-572707720, 1405237587}, {857976657, 1488953645}},
         {{348731968, -318073303}, {873663093, -901551358}, {1820680630, 1819704345}},
         {{1282268180, 967085546}, {-365332710, -1036515132}, {-2028167004, 1351502752}},
         {{-1112784761, -152412642}, {1439119510, 774384886}, {-1542223850, 367874854}},
         {{1817318618, 340749796}, {-1133789395, 949390661}, {-1927593991, -1994563421}},
         {{543065639, 88645030}, {2028298575, -257872797}, {-1936068027, -2103256251}},
         {{-994900283, -1159082340}, {298651255, 703539424}, {1118375813, -608744590}},
         {{-2089293717, -837024109}, {1325112188, -1630416421}, {-351275954, 1381919236}},
         {{142802965, -1520240563}, {75871734, -1853752121}, {1155990028, 994280014}},
         {{1027949685, -528814884}, {34656116, 1558680641}, {1540604008, -2070318883}},
         {{-1960554568, 2144934615}, {-13995763, 274690756}, {-2057836544, -1869618241}},
         {{1539471912, 609723804}, {-198051975, 8537362}, {-584832884, -162724128}},
         {{910595912, -35133466}, {1154167728, -2037741674}, {-423905200, 153593924}},
         {{-262004683, 1754550189}, {-442077497, -1342678000}, {-501215519, -526631955}},
         {{1648138908, 1472717235}, {-1672494362, -651140229}, {1545094931, 210668764}},
         {{1905205729, -1592894839}, {-822491698, -683421807}, {-1637119568, 1420907430}},
         {{-1388890514, -664256493}, {927540267, 2102549918}, {-1532066425, 341280450}},
         {{523308790, 892500328}, {-1942759658, -2130351178}, {580447374, -389154214}},
         {{-682101451, -1120158550}, {228316525, 902461414}, {-1274851153, 540634526}},
         {{618499274, -612886682}, {1222748556, -2145510487}, {997494949, -915448501}},
         {{-17721410, 1862578543}, {-210097169, 1095262419}, {-607992220, -1057011274}},
         {{1477674845, -292969320}, {-1539881789, 595274556}, {-2040798523, -107208378}},
         {{-2129064484, -1415778287}, {-753658157, -363739421}, {-1068798267, 1288548537}},
         {{707114968, 282834248}, {665903141, -1380219997}, {-162198416, 1501271184}},
         {{540846098, -1447508434}, {-1174653405, -486162948}, {-1067842358, 1337152758}},
         {{2061508409, -1629375556}, {-1747106280, 1068264028}, {871400101, 1627948127}},
         {{1255460507, -1619830216}, {167268444, 1687314679}, {851052957, 1386419660}},
         {{328240213, -64010761}, {-50009195, -969107666}, {665179102, -1987185658}},
         {{-2067818780, -1303507053}, {-866017224, 1935685319}, {186236373, -44200780}},
         {{-171602339, 1574543708}, {-820360905, 1688142471}, {-272815109, 454324819}},
         {{919745609, 374299384}, {1038850785, -1075042000}, {-831303059, -1895041820}},
         {{110811890, 1878244808}, {932879064, 589456526}, {441885132, -1187807664}},
         {{-1722064329, -1668598101}, {1331419336, 1299025648}, {-331344050, 1517467938}},
         {{872270649, -731422481}, {-1902671368, -545984070}, {1413543370, 1613690374}},
         {{2046331327, 516792135}, {299631688, -1719272881}, {-1353657283, -1752477107}},
         {{264555886, 2053166853}, {-957237740, -2000454926}, {-1118561324, 1985397214}},
         {{1718942364, -443491899}, {2013463527, 1501601713}, {-2119897755, 917368627}},
         {{-1057362791, 1403097739}, {-335468299, 1270873115}, {-236467150, 1733581326}},
         {{-451291959, -941725573}, {-154720642, -1096416242}, {-1996451548, -222160884}},
         {{-1964106600, 1352213491}, {-201497259, 2143147679}, {621926708, -633293752}},
         {{-457674860, 217835233}, {-411666608, -358981244}, {-140096455, -1141635925}},
         {{-595016633, 664406179}, {1767881640, 527353638}, {1876734123, -998307935}},
         {{-674607025, 1608598622}, {739600995, -2138307181}, {-2093383111, 501964549}},
         {{-310284650, 841516952}, {-782804848, 382566427}, {-1976495488, 1384459834}},
         {{602389425, -1090163848}, {-1025394008, -418873991}, {587441390, -627482789}},
         {{-989714038, -363531514}, {1122920687, -1335953091}, {1376528081, 1898701295}},
         {{661285323, 949312892}, {-418181817, 76325579}, {2009042946, 324420348}},
         {{-776780100, -1005558149}, {-1636262715, -597127981}, {1013037515, 2044849629}},
         {{586707854, 1742141470}, {125501238, -87989736}, {-1284976201, -1008326479}},
         {{-901655370, 1471717684}, {-378434817, 1455006938}, {-1506065465, 1896261011}},
         {{-1503608314, -1853653906}, {-722913526, -1279819645}, {701302606, 1879984790}},
         {{-1028906946, 1300626946}, {-823772717, 630025343}, {355094715, 826335173}},
         {{1509614562, 456894167}, {-1134297156, -353993700}, {-898159793, 414106569}},
         {{1923404635, 769239353}, {-559107773, -527576582}, {-211426024, -1442478548}},
         {{-237259117, 102021565}, {913295435, -859071817}, {1078104694, 2105359914}},
         {{-1335225457, 515039490}, {1673404667, 1078219515}, {-1405704899, 681279769}},
         {{-75152061, 1048602043}, {-1981050509, -674396601}, {897129484, 1150284416}},
         {{-2019948628, 682506888}, {-564228391, -439853878}, {-2104125849, -1276490571}},
         {{-2024305459, 1872239971}, {1231375535, -2083580061}, {-931472911, 882498927}},
         {{-837690639, -1085338204}, {1204845621, 519124376}, {-995933381, 689635606}},
         {{-516048968, 2136673335}, {-398501718, -2029228969}, {-1756634580, 1612238019}},
         {{-1895933171, -1178643069}, {2014546374, 2051228253}, {945253608, 1386903240}},
         {{84943800, -2122705712}, {-1426035640, 1327221401}, {-575485440, -2003462776}},
         {{-1696202360, 91626525}, {-203690245, 574464839}, {514241986, -719451960}},
         {{598215299, 448472268}, {1234474961, -1664351970}, {1393097346, -2025383873}},
         {{-596235579, -1315527449}, {-1974573922, -1565954266}, {-1917948, 1074464684}},
         {{-244958857, 1461822092}, {-1641494404, 1299320470}, {-412072107, 1722922465}},
         {{1961260307, -960325582}, {874336216, -442618140}, {1948525001, -17788189}},
         {{-1304433252, -2036896071}, {-1178740563, -343428239}, {-313019674, 776772368}},
         {{-798069111, -56327170}, {601317986, -2063717048}, {-1257043394, 1900964968}},
         {{1052266999, -103309560}, {-622094925, 85977726}, {2058313035, -867023996}},
         {{1704154564, 1286936533}, {-262456438, -971244691}, {-781272994, 833637441}},
         {{763927233, 782528419}, {-1844201859, 1274956114}, {-1836634965, 1004656177}},
         {{1766303864, 1011756737}, {-934916195, -596691077}, {1519983279, -549510743}},
         {{1586488787, -955762991}, {-1320998015, -1424524075}, {-468548288, -1854228008}},
         {{-588054696, -579711239}, {-1264120830, -384074826}, {-1122339433, -1369142367}},
         {{1178042108, -1201569961}, {-1887736208, -701403904}, {1805260160, 2007642064}},
         {{-181795015, -1609361439}, {21093838, -1224142695}, {-1839230509, -106553949}},
         {{-455083723, 1444253873}, {-1278860625, -1165342511}, {941753456, -819588976}},
         {{414387843, -987008818}, {-265086597, -1068109400}, {133697436, -1354443913}}}};

template<typename T>
const std::array<std::tuple<std::pair<int64_t, int64_t>, std::pair<int64_t, int64_t>, std::pair<int64_t, int64_t>>, 100> FixedTripleGenerator<T>::TRIPLES_64 = {
        {{{237556085256855946, 3336052888352788700}, {4989672409235184730, 8371165713635796012},
          {-1525225287641587115, 3435631551775227663}},
         {{7404258094028065398, -5348499364486513459}, {4582850899730458191, -1325544204114785518},
          {2511412437411717645, -2167734571475766954}},
         {{4298974060315659760, 1655954464007922930}, {8533331257255679583, -5001993773819829940},
          {3878787773114115742, 6151681994083099736}},
         {{7078728789243436497, -3153637688032678237}, {2306507723556057531, 7773880043902348610},
          {2537716380572243668, -8620906192370217008}},
         {{-652716803939267181, 9112746492764344800}, {-4894368931760186726, -4330192113468685609},
          {7084967568545492648, -5594073992109229541}},
         {{-1152243524063312073, -6599086851185892241}, {1302641220553749320, 8142111951528645931},
          {2347558920031764506, 760084042228271992}},
         {{2668974571920050751, -5764662953174658645}, {-48671422609419527, -1389728760225648601},
          {-7352529600423008210, 2007004460741546770}},
         {{1162905083568007293, -7528540648388265410}, {1538480622393059700, -5844338473195084142},
          {-6471329463013425392, 3903240412105113938}},
         {{9144487690326097749, -4499125353414248449}, {-5946589102227249593, 706993566215611296},
          {-3126179542736230799, 2375417589763668571}},
         {{-3632109087598516546, -4747314013971558882}, {-2419749134450037383, 702454233010454942},
          {2512228636141004887, -4174689756352545939}},
         {{2379175399396343952, -8110818925611319409}, {7847201208627752670, -7234905240290712665},
          {8914811864358541136, 6551931215162304203}},
         {{3148336127626892377, 5543279466395871462}, {-2113617542026645560, 7880932470408941469},
          {-3680567190782735968, 4148393201678803259}},
         {{1269863367695484717, -4536213372347120401}, {6757785020603657891, 8174749615907761660},
          {-1125649271594081067, -8791252943532347249}},
         {{-1626546737415094578, -8811345915319095522}, {2879463328534721528, -4839732201358549599},
          {57030655648409151, -617281554465998899}},
         {{-7535267365390693088, 2174791954242506846}, {-7977259001401068938, 6698222017110277064},
          {-162100387928248645, -7530824909580019255}},
         {{-3846289879146574851, -5115370768505110280}, {-1511187090658749031, 3477417270789296442},
          {-1607642369916517593, -5215642588283516728}},
         {{8667580947850808819, -1778823727397515751}, {2898731355507330700, -880298017722875750},
          {5981954718132193834, 1212978557563900830}},
         {{5138648657476900060, -3636594974083903207}, {-524305955121079030, 2990504875482553251},
          {3734977763916957779, 6447002221434107454}},
         {{264383954754840883, -2952418480072817712}, {6406936447406482138, 9086821290219373610},
          {-1964495575192008016, -287560240345276836}},
         {{-2308425676221749974, -8668751187477737241}, {-7975153564277297135, 4976312976691620077},
          {4056709284815048389, -5053228478324560359}},
         {{-9129821185506024944, 6017203044250375509}, {6250699775717015833, 4227847411508908770},
          {-9045333656114317948, -2417320631629047421}},
         {{3027238123877472543, -4474870231856415301}, {8163386230686494211, 6285395158451377634},
          {2139404634801930915, -7376540711912244129}},
         {{4497903315276220097, -5032056045996539895}, {-5330470937019015273, 5651644817832205833},
          {2832979972487901875, -206014204372456051}},
         {{7183391195261703283, -7307920802450185466}, {5622708773183742806, 3125963002041090243},
          {354871504907499657, -8420718496830802360}},
         {{4330997404593450542, 6739397230001378236}, {-952077683940089831, -290769324095454518},
          {2454335914171017057, -1864030910515355875}},
         {{3400551631230247818, 6866121948894044071}, {-7860180476021839738, -6337536798195906552},
          {8276068491437793919, -647080009036639569}},
         {{1548294071896990925, -907842927364215783}, {2520555361447542969, 3329829428273432256},
          {-5396873628576139965, 386208957563621747}},
         {{3704830667042266149, -8338615692959838397}, {6911502653471832858, 7290491170908565629},
          {-491206572513071945, 9069817738295387553}},
         {{4514615707798654950, -793914778805913868}, {7183105655806911080, -7956861933395217123},
          {-3786909536715757, 3490458739086993711}},
         {{23933341398091465, -2990890697421800339}, {4532201598674820325, -8019095191091603715},
          {4574662733055643113, 3697393027369486787}},
         {{-8777310496645847961, -1845509991946758143}, {-7499487096783900697, 5591594529591561980},
          {-4200139479279150605, 3611398167728088645}},
         {{-4182727389075182761, 8151529959489618348}, {-231106056990025475, -1595433107752515984},
          {-2636581903493637587, -9054159510535426790}},
         {{5368766187635423545, -7448420511026356088}, {804329548842555045, -69274906040640898},
          {-1703649416711180847, -8824927496251209582}},
         {{-3347058707202374899, -1886922708793713560}, {-4885549127326993584, 1153683452838191420},
          {-2499065388273456148, 6394129783489473552}},
         {{-7018911165895514928, -5302513285304133627}, {6903329849295293074, -5711436567201414710},
          {7282652906126423455, -2209029612889021715}},
         {{-6049645101577653835, 2941054038923155746}, {7448923993012790830, -2869200511913436032},
          {-7792971112736874323, -4553463811079066763}},
         {{-4741124664116556987, -3382355814178389634}, {3570825289439886740, 4803495621550431535},
          {-4558398509893578786, -5984953699307604309}},
         {{-7605573132352733361, 4842271459974003120}, {6606864478903665023, -522824922932114402},
          {-2629327395549083480, -6664139241548800325}},
         {{-8499950138575585602, 188280034033999388}, {991538775153591304, -7708629196982975151},
          {-2669045237788314298, 6766962372662705284}},
         {{-8484732511453252162, 4518438402694158125}, {-8239383809067852472, -6799409655457513361},
          {2473758467024629081, -2207841610642592348}},
         {{3191102497924247091, 4902401027538999532}, {4943765038771542944, 3875411818000484118},
          {1708204291523968262, -6733178146715193084}},
         {{6242459227918655019, -335468350890370036}, {3082785579660441272, -3294216705418668031},
          {-8223461196292212066, 1920654642084043041}},
         {{-2446420634116597602, -2287183373487334906}, {3203579116912417492, 4167881372772314832},
          {-6792349097832143178, -8365283954155123110}},
         {{-5990769752563175253, 4619616618631452436}, {-3517538616577874342, 7142868578475859838},
          {-7774622012598641408, 2196581616866469672}},
         {{-789719873067506097, -6346734798465502710}, {3543580319381665799, -6574087642039619969},
          {6157366237466461392, -9008793838902284346}},
         {{-5461167345408953988, -2338244170226789604}, {-6910311697053846253, 5493157809966119177},
          {-6739389218005611771, -6033256796904143461}},
         {{2243032307132650935, -1592990566558089567}, {8239632128474468430, 4246129864804118086},
          {-1748188557743116845, 965416674919146765}},
         {{1082943523034375924, 3955280232958993327}, {8831876215444109144, 8201866700055247349},
          {5295201974769506637, -4357677692584194886}},
         {{-6777407634464196827, 3571111672659025927}, {6134731034739231329, 1987208463762939289},
          {8060142663347299270, -3231004049755115214}},
         {{-3471884445112721146, -6352349169829212157}, {6988630958222863166, 8671549762380494641},
          {7785656318006230890, -3447544218215926403}},
         {{-1026281523770262294, 6757662784733697163}, {-6847245425304554009, -3337778360937944326},
          {-4568042698204239116, 2475000505237146849}},
         {{-83912791424107397, 4833070966218915774}, {7076715579145456815, -2635521076900726094},
          {6951845431313051689, -4143366017195282320}},
         {{-7902166076513733352, -8256921322424463219}, {6700273938989042665, 603862037808116755},
          {-1302255798380840783, -3288854616522886981}},
         {{8337131732654603171, -2963293419173927377}, {-354280934115596088, -4343917158130866008},
          {-6326406200544298503, -4493439448919718937}},
         {{321797069828791910, -3270564903073622548}, {4014483228082122793, 6115677527276406315},
          {627535053659549079, 2138157022014359889}},
         {{8194758685483426920, 4125535605571888781}, {-8474491275045683872, -6375896124273420676},
          {1197999554299222360, -7586414119949598668}},
         {{4248103725790733816, 418402373754158394}, {2475660828996116263, -6960405181867526484},
          {6975353738882696017, -4671465726866269979}},
         {{-5349983591382662700, 8859633643811287445}, {-3859450032142556617, 9164715398202539565},
          {3762008238207020343, -3707711337231677491}},
         {{6910819444898312367, -5033251536312921817}, {3187747194011855572, 91463138310778130},
          {1705318764442632976, 8138638479521881396}},
         {{-3479447581209825811, 9202095673080465681}, {197760626546714062, 3084435732955650769},
          {-7488760708278214077, 5244395216722560383}},
         {{-7144222858618865992, -1968297924638432155}, {-3072212744141097804, -2883388972122312749},
          {-55299760627648310, -5919748253900314751}},
         {{-1723894649111042552, 983091089801483599}, {-1866037729208812544, -150570326202117549},
          {-2001151543408636143, 2737523152376328228}},
         {{5002863836032518993, 5315714554014804435}, {-1863485846430845308, 4251367327605638469},
          {5291432300692938189, 2029490367814248311}},
         {{-6870924127788332841, 2199472455505777743}, {-6556918596724328756, 4009183998596587479},
          {-1669947316305596577, 1711195601393705939}},
         {{-3040939497905125769, -2811594134756815570}, {15858958157587824, 847386835568641547},
          {-1858558082142945635, 7006232847230249130}},
         {{-621310138378359449, -5936690645919949789}, {1205602006653656417, 4063168103276293775},
          {2703312431539411937, 5918818655041225599}},
         {{-159438536691122197, 5966555130297698816}, {-7050562626817979954, 7693138817697619628},
          {4284522237875766633, 8557553159694068885}},
         {{-1819689431239960804, -5122860703953601152}, {-5710331843786074459, 750227491478854573},
          {-2719504573766477840, 1437655243311135240}},
         {{-7158202926500470538, 1464154418976933609}, {-3009010352246523855, -6202522962254177150},
          {5159335247084703944, -6374926393176884187}},
         {{501951933060558733, -2883803877318511881}, {7428765626122036454, -3831115151958980791},
          {-5001570944327946209, 1626965267089970717}},
         {{-5162168705156971969, 3695918860783968378}, {-4730071711861517248, -4713039897348407088},
          {-3413853557717758789, -507018907220538411}},
         {{-8240639135656242613, -9051291488214148971}, {6386924041129302728, -1942513858925904796},
          {-6481661389183158693, -1961037938277218267}},
         {{2189523644194607531, 8268435439555121859}, {1722976307030175892, 8757965537807575129},
          {-3867725251732655917, 2717869980603750659}},
         {{8276539993371953892, -8864327852219936147}, {-8560863004803791805, -1130994032578300713},
          {-7060703398263868823, -6589050101240983343}},
         {{8238258935372683910, 5345285229682734546}, {-8198120842801626827, -6803539662905629858},
          {-6790741039115028945, 8456858228434783321}},
         {{7925816595747565173, 3006862006247882659}, {-6650860485584667893, 47158044768558955},
          {-1420262469994898463, -3282423911662775505}},
         {{3104927343559507011, 7155930243833699492}, {4670320582536748933, -331072791582342064},
          {-3915835291887884840, -7582997711227197605}},
         {{5227722682506219658, -7434985314177618479}, {617264402975887134, 3498775537958012805},
          {8692332810657119863, -3218086256833968262}},
         {{-9109393964179229409, -7939532652273182163}, {5395154939347581354, 3121761922873861190},
          {-3969670048908407508, 1340425447511057940}},
         {{-3917535961135559148, 477828242487537258}, {-7301377321978484476, -8487607929589095391},
          {1568290252613904016, 8189681790084824486}},
         {{-2516289992372388491, 6220547362315067838}, {-4431619903606490030, 4454207654851283002},
          {-2356439672755617035, -5880939353175828241}},
         {{-4814136752322364417, -8458238798013522720}, {2227052236338968071, -3157662563384107825},
          {-4519071833530838049, -3064941462573013877}},
         {{1647095463346106934, -5728680861427740804}, {-7920848865275074967, -7688677259140221790},
          {9098501305917012579, 4299115390906375747}},
         {{6172515072710715073, -2173722525994966190}, {-7142648063017520481, 8427519452475880838},
          {-2348880457909085251, -7005479045930282750}},
         {{6018417570384700066, 2969058229717581856}, {4420917993005097363, 1240341965344053709},
          {6567304703027306426, 6995014470035824390}},
         {{-8513528762907558238, -4508099327349972239}, {-6144568351906206433, -8423209669049182738},
          {497687382369590861, 1433024064329387818}},
         {{3800370290440640206, -2809204746150709492}, {-7192462253260614995, -7543706212229434257},
          {-429146395098894302, 3203662420787775926}},
         {{-6010875969160923956, -6147027769643093002}, {3047498329029795181, -8135773558610162680},
          {-5235205552586614666, 7893123425500289588}},
         {{-4691152355600593012, 5542711493525222950}, {-1510141274507044220, -3498196465338270258},
          {3047867207961274765, 6003743104391682423}},
         {{-7720522665810884360, -7977101657570873358}, {-7770360770616674960, 6955237399370018630},
          {-6285863043593731572, 6133660261788965968}},
         {{-1323304166778193896, -2551085892827887862}, {-5772111282437571544, 3950789856437400345},
          {-3465080300675220500, 2434589270422407606}},
         {{-1067041849651799127, 2953565089330043618}, {7576882456989716509, 2436463522164930858},
          {4578085571622620021, -4161424167803078632}},
         {{6818389429700003464, -5439889010871731415}, {-2599304274522051684, -941876433649210099},
          {2858256781618639960, 5406069280666517889}},
         {{3185219998341889325, 1847251157324704200}, {-8900947451820636670, 633880564521775796},
          {1983228950917164859, -3034104674548901133}},
         {{5834268372281142647, -2197199369390827559}, {-7271344533805124960, -7562950461720462945},
          {4920441851105880418, 4514692461014345038}},
         {{-2287331919276137152, 8995675643482790964}, {-1935330919548331357, 1535437587802374583},
          {6042162322109310556, 3178429434802474092}},
         {{496808125091471534, 8850740819695014962}, {-1463600660399824573, 2632596350834871882},
          {3864973269815982265, -6911692533169813849}},
         {{4671304394742972773, -992120258886630959}, {4528916656564085030, -75226880818564609},
          {-572179912848598243, 4589404525256875441}},
         {{3778598144892707735, -3232568384817235641}, {-868514309945053611, 7311158965824697238},
          {6381744256363693258, -6373062427341678336}},
         {{8397214751674033102, 2638669615026703774}, {8615649459625766843, 1539544607127817914},
          {-6355079758900639614, -3763763334088444454}}}};

template
class FixedTripleGenerator<bool>;

template
class FixedTripleGenerator<int8_t>;

template
class FixedTripleGenerator<int16_t>;

template
class FixedTripleGenerator<int32_t>;

template
class FixedTripleGenerator<int64_t>;